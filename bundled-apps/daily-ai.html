<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>DailyAI - æ¯æ—¥ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        brand: {
          50: '#fff8f0',
          100: '#ffedd5',
          200: '#fed7aa',
          300: '#fdba74',
          400: '#fb923c',
          500: '#f97316',
          600: '#ea580c',
          700: '#c2410c',
          800: '#9a3412',
          900: '#7c2d12',
        }
      }
    }
  }
}
</script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap');

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: 'Noto Sans JP', sans-serif;
  background: #fef7f0;
  min-height: 100vh;
  overscroll-behavior: none;
}

.gradient-brand {
  background: linear-gradient(135deg, #f97316, #f59e0b, #ef4444);
}

.gradient-brand-soft {
  background: linear-gradient(135deg, #fff7ed, #fffbeb, #fef2f2);
}

.gradient-text {
  background: linear-gradient(135deg, #f97316, #ef4444);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.tab-panel {
  display: none;
  opacity: 0;
  transform: translateY(12px);
  transition: opacity 0.35s ease, transform 0.35s ease;
}

.tab-panel.active {
  display: block;
}

.tab-panel.visible {
  opacity: 1;
  transform: translateY(0);
}

.upload-zone {
  border: 2px dashed #fdba74;
  background: linear-gradient(135deg, #fff7ed, #fffbeb);
  transition: all 0.3s ease;
}

.upload-zone:hover,
.upload-zone.dragover {
  border-color: #f97316;
  background: linear-gradient(135deg, #ffedd5, #fef3c7);
  transform: scale(1.01);
}

.upload-zone.has-image {
  border-style: solid;
  border-color: #f97316;
}

.bounce-dot {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #f97316;
  animation: bounce-dot 1.4s infinite ease-in-out both;
}

.bounce-dot:nth-child(1) { animation-delay: -0.32s; }
.bounce-dot:nth-child(2) { animation-delay: -0.16s; }
.bounce-dot:nth-child(3) { animation-delay: 0s; }

@keyframes bounce-dot {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}

.result-card {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.result-card.show {
  opacity: 1;
  transform: translateY(0);
}

.btn-gradient {
  background: linear-gradient(135deg, #f97316, #ef4444);
  transition: all 0.3s ease;
}

.btn-gradient:hover {
  background: linear-gradient(135deg, #ea580c, #dc2626);
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(249, 115, 22, 0.4);
}

.btn-gradient:active {
  transform: translateY(0);
}

.nav-item {
  transition: all 0.3s ease;
  position: relative;
}

.nav-item.active {
  color: #f97316;
}

.nav-item.active::before {
  content: '';
  position: absolute;
  top: -2px;
  left: 50%;
  transform: translateX(-50%);
  width: 24px;
  height: 3px;
  background: linear-gradient(135deg, #f97316, #ef4444);
  border-radius: 2px;
}

.action-btn {
  transition: all 0.2s ease;
}

.action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.action-btn:active {
  transform: translateY(0);
}

.fade-in {
  animation: fadeIn 0.5s ease forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.pulse-ring {
  animation: pulse-ring 2s ease-in-out infinite;
}

@keyframes pulse-ring {
  0%, 100% { box-shadow: 0 0 0 0 rgba(249, 115, 22, 0.3); }
  50% { box-shadow: 0 0 0 8px rgba(249, 115, 22, 0); }
}

.toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-100px);
  background: #1f2937;
  color: white;
  padding: 10px 24px;
  border-radius: 12px;
  font-size: 14px;
  z-index: 9999;
  transition: transform 0.4s ease;
  white-space: nowrap;
}

.toast.show {
  transform: translateX(-50%) translateY(0);
}

::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #fdba74; border-radius: 4px; }
</style>
</head>
<body class="pb-20">

<!-- Toast notification -->
<div id="toast" class="toast"></div>

<!-- Header -->
<header class="gradient-brand text-white px-5 pt-10 pb-6 rounded-b-3xl shadow-lg relative overflow-hidden">
  <div class="absolute inset-0 opacity-10">
    <div class="absolute -top-10 -right-10 w-40 h-40 bg-white rounded-full"></div>
    <div class="absolute -bottom-5 -left-5 w-28 h-28 bg-white rounded-full"></div>
    <div class="absolute top-1/2 right-1/4 w-16 h-16 bg-white rounded-full"></div>
  </div>
  <div class="relative z-10">
    <div class="flex items-center justify-between mb-2">
      <div>
        <h1 class="text-2xl font-bold tracking-tight">DailyAI</h1>
        <p class="text-orange-100 text-xs mt-0.5">æ¯æ—¥ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</p>
      </div>
      <div class="text-right">
        <p id="header-date" class="text-sm font-medium text-orange-100"></p>
        <p id="header-time" class="text-xl font-bold tabular-nums"></p>
      </div>
    </div>
    <div class="mt-3 bg-white/15 backdrop-blur rounded-xl px-4 py-3 flex items-center gap-3">
      <span id="greeting-emoji" class="text-2xl"></span>
      <div>
        <p id="greeting-text" class="font-semibold text-sm"></p>
        <p id="greeting-sub" class="text-orange-100 text-xs"></p>
      </div>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="px-4 pt-5 pb-4 max-w-lg mx-auto">

  <!-- Tab 1: ã‚³ãƒ¼ãƒ‡ææ¡ˆ (WardrobeAI) -->
  <div id="panel-wardrobe" class="tab-panel active visible">
    <div class="mb-4">
      <div class="flex items-center gap-2 mb-1">
        <span class="text-2xl">ğŸ‘—</span>
        <h2 class="text-lg font-bold text-gray-800">ã‚³ãƒ¼ãƒ‡ææ¡ˆ</h2>
      </div>
      <p class="text-xs text-gray-500 ml-10">ã‚¯ãƒ­ãƒ¼ã‚¼ãƒƒãƒˆã®å†™çœŸã‹ã‚‰AIãŒä»Šæ—¥ã®ã‚³ãƒ¼ãƒ‡ã‚’ææ¡ˆã—ã¾ã™</p>
    </div>

    <div id="upload-wardrobe" class="upload-zone rounded-2xl p-8 text-center cursor-pointer mb-4" onclick="document.getElementById('file-wardrobe').click()" ondragover="handleDragOver(event, this)" ondragleave="handleDragLeave(event, this)" ondrop="handleDrop(event, this, 'wardrobe')">
      <input type="file" id="file-wardrobe" accept="image/*" class="hidden" onchange="handleFileSelect(this, 'wardrobe')">
      <div id="upload-wardrobe-placeholder">
        <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-orange-100 flex items-center justify-center">
          <svg class="w-8 h-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
        </div>
        <p class="text-sm font-medium text-gray-600 mb-1">ã‚¯ãƒ­ãƒ¼ã‚¼ãƒƒãƒˆã®å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
        <p class="text-xs text-gray-400">ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
      </div>
      <div id="upload-wardrobe-preview" class="hidden">
        <img id="preview-wardrobe" class="max-h-48 mx-auto rounded-xl shadow" alt="preview">
        <p class="text-xs text-orange-600 mt-2 font-medium">å†™çœŸã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã‚¿ãƒƒãƒ—</p>
      </div>
    </div>

    <button id="btn-wardrobe" onclick="analyzeWardrobe()" class="btn-gradient w-full text-white font-bold py-3.5 rounded-xl text-sm shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
      <span id="btn-wardrobe-text">AIã§åˆ†æã™ã‚‹</span>
      <span id="btn-wardrobe-loading" class="hidden">
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
      </span>
    </button>

    <div id="result-wardrobe" class="mt-5 space-y-3 hidden">
      <!-- Weather card -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">ğŸŒ¤ï¸</span>
          <h3 class="font-bold text-sm text-gray-800">ä»Šæ—¥ã®å¤©æ°—</h3>
        </div>
        <div class="flex items-center justify-between bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-3">
          <div>
            <p class="text-2xl font-bold text-gray-800">22Â°C</p>
            <p class="text-xs text-gray-500">æ™´ã‚Œæ™‚ã€…æ›‡ã‚Š</p>
          </div>
          <div class="text-right text-xs text-gray-500">
            <p>æ¹¿åº¦: 55%</p>
            <p>é™æ°´ç¢ºç‡: 10%</p>
            <p>é¢¨é€Ÿ: 3m/s</p>
          </div>
        </div>
      </div>

      <!-- Outfit suggestion card -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">âœ¨</span>
          <h3 class="font-bold text-sm text-gray-800">ãŠã™ã™ã‚ã‚³ãƒ¼ãƒ‡</h3>
        </div>
        <div class="space-y-2.5">
          <div class="flex items-center gap-3 bg-orange-50 rounded-xl p-3">
            <span class="text-2xl">ğŸ‘•</span>
            <div>
              <p class="text-xs text-gray-400 font-medium">ãƒˆãƒƒãƒ—ã‚¹</p>
              <p class="text-sm font-semibold text-gray-700">ãƒ™ãƒ¼ã‚¸ãƒ¥ã®ãƒªãƒãƒ³ã‚·ãƒ£ãƒ„</p>
              <p class="text-xs text-gray-500">è»½ã„ç´ æã§å¿«é©ã€‚è¢–ã‚’ãƒ­ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨çˆ½ã‚„ã‹ã«</p>
            </div>
          </div>
          <div class="flex items-center gap-3 bg-amber-50 rounded-xl p-3">
            <span class="text-2xl">ğŸ‘–</span>
            <div>
              <p class="text-xs text-gray-400 font-medium">ãƒœãƒˆãƒ ã‚¹</p>
              <p class="text-sm font-semibold text-gray-700">ãƒã‚¤ãƒ“ãƒ¼ã®ãƒ¯ã‚¤ãƒ‰ãƒ‘ãƒ³ãƒ„</p>
              <p class="text-xs text-gray-500">ã‚†ã£ãŸã‚Šã‚·ãƒ«ã‚¨ãƒƒãƒˆã§ãƒªãƒ©ãƒƒã‚¯ã‚¹æ„Ÿã‚’æ¼”å‡º</p>
            </div>
          </div>
          <div class="flex items-center gap-3 bg-yellow-50 rounded-xl p-3">
            <span class="text-2xl">ğŸ‘Ÿ</span>
            <div>
              <p class="text-xs text-gray-400 font-medium">ã‚·ãƒ¥ãƒ¼ã‚º</p>
              <p class="text-sm font-semibold text-gray-700">ç™½ã®ãƒ¬ã‚¶ãƒ¼ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼</p>
              <p class="text-xs text-gray-500">æ¸…æ½”æ„Ÿã®ã‚ã‚‹è¶³å…ƒã§å…¨ä½“ã‚’å¼•ãç· ã‚</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Style tip card -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-2">
          <span class="text-lg">ğŸ’¡</span>
          <h3 class="font-bold text-sm text-gray-800">ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚³ãƒ„</h3>
        </div>
        <p class="text-sm text-gray-600 leading-relaxed">ä»Šæ—¥ã¯æ°—æ¸©ãŒé«˜ã‚ãªã®ã§ã€ã‚¢ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ã§çµ±ä¸€ã™ã‚‹ã¨ã¾ã¨ã¾ã‚Šæ„ŸUPã€‚ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã«ã‚´ãƒ¼ãƒ«ãƒ‰ç³»ã®è…•æ™‚è¨ˆã‚„ãƒ–ãƒ¬ã‚¹ãƒ¬ãƒƒãƒˆã‚’åˆã‚ã›ã‚‹ã¨ã€ã•ã‚Šã’ãªã„ãŠã—ã‚ƒã‚Œæ„ŸãŒå‡ºã¾ã™ã€‚æ—¥å·®ã—ãŒå¼·ã„ã®ã§ã‚µãƒ³ã‚°ãƒ©ã‚¹ã‚‚ãŠã™ã™ã‚ã§ã™ã€‚</p>
      </div>

      <!-- Action buttons -->
      <div class="flex gap-2 pt-1">
        <button onclick="copyResult('wardrobe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
          ã‚³ãƒ”ãƒ¼
        </button>
        <button onclick="downloadResult('wardrobe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
          ä¿å­˜
        </button>
        <button onclick="retryAnalysis('wardrobe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
          å†åˆ†æ
        </button>
      </div>
    </div>
  </div>

  <!-- Tab 2: ã‚«ãƒ­ãƒªãƒ¼è§£æ (MenuAI) -->
  <div id="panel-calorie" class="tab-panel">
    <div class="mb-4">
      <div class="flex items-center gap-2 mb-1">
        <span class="text-2xl">ğŸ±</span>
        <h2 class="text-lg font-bold text-gray-800">ã‚«ãƒ­ãƒªãƒ¼è§£æ</h2>
      </div>
      <p class="text-xs text-gray-500 ml-10">æ–™ç†ã®å†™çœŸã‚’æ’®ã‚‹ã ã‘ã§AIãŒæ „é¤Šç´ ã‚’åˆ†æã—ã¾ã™</p>
    </div>

    <div id="upload-calorie" class="upload-zone rounded-2xl p-8 text-center cursor-pointer mb-4" onclick="document.getElementById('file-calorie').click()" ondragover="handleDragOver(event, this)" ondragleave="handleDragLeave(event, this)" ondrop="handleDrop(event, this, 'calorie')">
      <input type="file" id="file-calorie" accept="image/*" class="hidden" onchange="handleFileSelect(this, 'calorie')">
      <div id="upload-calorie-placeholder">
        <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-orange-100 flex items-center justify-center">
          <svg class="w-8 h-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
        </div>
        <p class="text-sm font-medium text-gray-600 mb-1">æ–™ç†ã®å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
        <p class="text-xs text-gray-400">ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
      </div>
      <div id="upload-calorie-preview" class="hidden">
        <img id="preview-calorie" class="max-h-48 mx-auto rounded-xl shadow" alt="preview">
        <p class="text-xs text-orange-600 mt-2 font-medium">å†™çœŸã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã‚¿ãƒƒãƒ—</p>
      </div>
    </div>

    <button id="btn-calorie" onclick="analyzeCalorie()" class="btn-gradient w-full text-white font-bold py-3.5 rounded-xl text-sm shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
      <span id="btn-calorie-text">AIã§åˆ†æã™ã‚‹</span>
      <span id="btn-calorie-loading" class="hidden">
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
      </span>
    </button>

    <div id="result-calorie" class="mt-5 space-y-3 hidden">
      <!-- Detected food -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">ğŸ”</span>
          <h3 class="font-bold text-sm text-gray-800">æ¤œå‡ºã•ã‚ŒãŸæ–™ç†</h3>
        </div>
        <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4">
          <p class="text-lg font-bold text-gray-800 mb-1">é¶ã®ç…§ã‚Šç„¼ãå®šé£Ÿ</p>
          <div class="flex flex-wrap gap-1.5 mt-2">
            <span class="bg-orange-100 text-orange-700 text-xs px-2.5 py-1 rounded-full font-medium">ç…§ã‚Šç„¼ããƒã‚­ãƒ³</span>
            <span class="bg-orange-100 text-orange-700 text-xs px-2.5 py-1 rounded-full font-medium">ç™½ç±³</span>
            <span class="bg-orange-100 text-orange-700 text-xs px-2.5 py-1 rounded-full font-medium">å‘³å™Œæ±</span>
            <span class="bg-orange-100 text-orange-700 text-xs px-2.5 py-1 rounded-full font-medium">ã‚µãƒ©ãƒ€</span>
            <span class="bg-orange-100 text-orange-700 text-xs px-2.5 py-1 rounded-full font-medium">æ¼¬ç‰©</span>
          </div>
        </div>
      </div>

      <!-- Calorie breakdown -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">ğŸ”¥</span>
          <h3 class="font-bold text-sm text-gray-800">ã‚«ãƒ­ãƒªãƒ¼ãƒ»æ „é¤Šç´ </h3>
        </div>
        <div class="text-center mb-4">
          <p class="text-4xl font-bold gradient-text">687</p>
          <p class="text-xs text-gray-400 font-medium">kcalï¼ˆæ¨å®šï¼‰</p>
        </div>
        <div class="grid grid-cols-3 gap-2 mb-3">
          <div class="bg-red-50 rounded-xl p-3 text-center">
            <p class="text-xs text-red-400 font-medium mb-1">ã‚¿ãƒ³ãƒ‘ã‚¯è³ª</p>
            <p class="text-xl font-bold text-red-600">38.2g</p>
            <div class="w-full bg-red-100 rounded-full h-1.5 mt-2">
              <div class="bg-red-400 h-1.5 rounded-full" style="width: 76%"></div>
            </div>
          </div>
          <div class="bg-yellow-50 rounded-xl p-3 text-center">
            <p class="text-xs text-yellow-500 font-medium mb-1">è„‚è³ª</p>
            <p class="text-xl font-bold text-yellow-600">18.5g</p>
            <div class="w-full bg-yellow-100 rounded-full h-1.5 mt-2">
              <div class="bg-yellow-400 h-1.5 rounded-full" style="width: 42%"></div>
            </div>
          </div>
          <div class="bg-blue-50 rounded-xl p-3 text-center">
            <p class="text-xs text-blue-400 font-medium mb-1">ç‚­æ°´åŒ–ç‰©</p>
            <p class="text-xl font-bold text-blue-600">82.1g</p>
            <div class="w-full bg-blue-100 rounded-full h-1.5 mt-2">
              <div class="bg-blue-400 h-1.5 rounded-full" style="width: 65%"></div>
            </div>
          </div>
        </div>
        <div class="grid grid-cols-2 gap-2">
          <div class="bg-gray-50 rounded-lg p-2 flex items-center justify-between">
            <span class="text-xs text-gray-500">é£Ÿç‰©ç¹Šç¶­</span>
            <span class="text-xs font-bold text-gray-700">4.8g</span>
          </div>
          <div class="bg-gray-50 rounded-lg p-2 flex items-center justify-between">
            <span class="text-xs text-gray-500">ç³–è³ª</span>
            <span class="text-xs font-bold text-gray-700">77.3g</span>
          </div>
        </div>
      </div>

      <!-- Salt warning -->
      <div class="result-card bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl p-4 border border-red-200">
        <div class="flex items-center gap-2 mb-2">
          <span class="text-lg">âš ï¸</span>
          <h3 class="font-bold text-sm text-red-700">å¡©åˆ†æ³¨æ„</h3>
        </div>
        <p class="text-sm text-red-600 leading-relaxed">ã“ã®é£Ÿäº‹ã®æ¨å®šå¡©åˆ†é‡ã¯ <span class="font-bold">3.8g</span> ã§ã™ã€‚1æ—¥ã®ç›®æ¨™æ‘‚å–é‡ï¼ˆ7.5gæœªæº€ï¼‰ã®ç´„åŠåˆ†ã«ç›¸å½“ã—ã¾ã™ã€‚å‘³å™Œæ±ã®å¡©åˆ†ãŒé«˜ã‚ãªã®ã§ã€å¤•é£Ÿã§ã¯å¡©åˆ†æ§ãˆã‚ãªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸ã¶ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚</p>
      </div>

      <!-- Suggestion -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-2">
          <span class="text-lg">ğŸ’¡</span>
          <h3 class="font-bold text-sm text-gray-800">æ”¹å–„ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
        </div>
        <ul class="space-y-2 text-sm text-gray-600">
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">â—</span>
            <span>ç™½ç±³ã‚’ç„ç±³ã«å¤‰ãˆã‚‹ã¨é£Ÿç‰©ç¹Šç¶­ãŒç´„3å€ã«ã€‚è¡€ç³–å€¤ã®ä¸Šæ˜‡ã‚‚ã‚†ã‚‹ã‚„ã‹ã«ãªã‚Šã¾ã™ã€‚</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">â—</span>
            <span>ã‚µãƒ©ãƒ€ã«ã‚¢ãƒãƒ‹æ²¹ã‚’ã‹ã‘ã‚‹ã¨ã‚ªãƒ¡ã‚¬3è„‚è‚ªé…¸ã‚’è£œçµ¦ã§ãã¾ã™ã€‚</span>
          </li>
          <li class="flex items-start gap-2">
            <span class="text-green-500 mt-0.5">â—</span>
            <span>å…¨ä½“çš„ã«ãƒãƒ©ãƒ³ã‚¹ã®è‰¯ã„é£Ÿäº‹ã§ã™ã€‚ã“ã®èª¿å­ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ï¼</span>
          </li>
        </ul>
      </div>

      <!-- Action buttons -->
      <div class="flex gap-2 pt-1">
        <button onclick="copyResult('calorie')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
          ã‚³ãƒ”ãƒ¼
        </button>
        <button onclick="downloadResult('calorie')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
          ä¿å­˜
        </button>
        <button onclick="retryAnalysis('calorie')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
          å†åˆ†æ
        </button>
      </div>
    </div>
  </div>

  <!-- Tab 3: ãƒ¬ã‚·ãƒ”ææ¡ˆ (RecipeAI) -->
  <div id="panel-recipe" class="tab-panel">
    <div class="mb-4">
      <div class="flex items-center gap-2 mb-1">
        <span class="text-2xl">ğŸ§‘â€ğŸ³</span>
        <h2 class="text-lg font-bold text-gray-800">ãƒ¬ã‚·ãƒ”ææ¡ˆ</h2>
      </div>
      <p class="text-xs text-gray-500 ml-10">å†·è”µåº«ã®å†™çœŸã‹ã‚‰AIãŒãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¾ã™</p>
    </div>

    <div id="upload-recipe" class="upload-zone rounded-2xl p-8 text-center cursor-pointer mb-4" onclick="document.getElementById('file-recipe').click()" ondragover="handleDragOver(event, this)" ondragleave="handleDragLeave(event, this)" ondrop="handleDrop(event, this, 'recipe')">
      <input type="file" id="file-recipe" accept="image/*" class="hidden" onchange="handleFileSelect(this, 'recipe')">
      <div id="upload-recipe-placeholder">
        <div class="w-16 h-16 mx-auto mb-3 rounded-full bg-orange-100 flex items-center justify-center">
          <svg class="w-8 h-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
        </div>
        <p class="text-sm font-medium text-gray-600 mb-1">å†·è”µåº«ã®å†™çœŸã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</p>
        <p class="text-xs text-gray-400">ã‚¿ãƒƒãƒ—ã—ã¦é¸æŠ ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
      </div>
      <div id="upload-recipe-preview" class="hidden">
        <img id="preview-recipe" class="max-h-48 mx-auto rounded-xl shadow" alt="preview">
        <p class="text-xs text-orange-600 mt-2 font-medium">å†™çœŸã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã‚¿ãƒƒãƒ—</p>
      </div>
    </div>

    <button id="btn-recipe" onclick="analyzeRecipe()" class="btn-gradient w-full text-white font-bold py-3.5 rounded-xl text-sm shadow-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>
      <span id="btn-recipe-text">AIã§åˆ†æã™ã‚‹</span>
      <span id="btn-recipe-loading" class="hidden">
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
        <span class="bounce-dot"></span>
      </span>
    </button>

    <div id="result-recipe" class="mt-5 space-y-3 hidden">
      <!-- Detected ingredients -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-3">
          <span class="text-lg">ğŸ¥¬</span>
          <h3 class="font-bold text-sm text-gray-800">æ¤œå‡ºã•ã‚ŒãŸé£Ÿæ</h3>
        </div>
        <div class="flex flex-wrap gap-1.5">
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">é¶ã‚‚ã‚‚è‚‰</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ã«ã‚“ã˜ã‚“</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ç‰ã­ã</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ã˜ã‚ƒãŒã„ã‚‚</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">åµ</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ç‰›ä¹³</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ã—ã‚ã˜</span>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1.5 rounded-full font-medium">ã»ã†ã‚Œã‚“è‰</span>
          <span class="bg-yellow-100 text-yellow-700 text-xs px-3 py-1.5 rounded-full font-medium">ãƒã‚¿ãƒ¼</span>
          <span class="bg-yellow-100 text-yellow-700 text-xs px-3 py-1.5 rounded-full font-medium">ãƒãƒ¼ã‚º</span>
        </div>
      </div>

      <!-- Recipe 1 -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center gap-2">
            <span class="bg-orange-100 text-orange-700 text-xs font-bold px-2 py-0.5 rounded-md">01</span>
            <h3 class="font-bold text-sm text-gray-800">ãƒã‚­ãƒ³ã‚¯ãƒªãƒ¼ãƒ ã‚·ãƒãƒ¥ãƒ¼</h3>
          </div>
          <span class="text-xs text-gray-400 bg-gray-50 px-2 py-1 rounded-lg font-medium">â± 35åˆ†</span>
        </div>
        <p class="text-xs text-gray-500 mb-3">é¶ã‚‚ã‚‚è‚‰ãƒ»ã«ã‚“ã˜ã‚“ãƒ»ç‰ã­ããƒ»ã˜ã‚ƒãŒã„ã‚‚ãƒ»ã—ã‚ã˜ãƒ»ç‰›ä¹³ãƒ»ãƒã‚¿ãƒ¼</p>
        <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-3">
          <p class="text-xs text-gray-600 leading-relaxed"><span class="font-semibold text-gray-700">ä½œã‚Šæ–¹ï¼š</span>é¶ã‚‚ã‚‚è‚‰ã‚’ä¸€å£å¤§ã«åˆ‡ã‚Šã€ç‰ã­ããƒ»ã«ã‚“ã˜ã‚“ãƒ»ã˜ã‚ƒãŒã„ã‚‚ã‚’ä¹±åˆ‡ã‚Šã«ã€‚ãƒã‚¿ãƒ¼ã§é¶è‚‰ã‚’ç‚’ã‚ã€é‡èœã¨ã—ã‚ã˜ã‚’åŠ ãˆã¦æ°´400mlã§15åˆ†ç…®è¾¼ã‚€ã€‚ç‰›ä¹³200mlã¨å°éº¦ç²‰å¤§ã•ã˜2ã‚’åŠ ãˆã€ã¨ã‚ã¿ãŒã¤ãã¾ã§ç…®ãŸã‚‰å®Œæˆã€‚</p>
        </div>
        <div class="flex items-center gap-3 mt-2 text-xs text-gray-400">
          <span>ğŸ”¥ ç´„420kcal</span>
          <span>ğŸ‘¤ 2äººå‰</span>
          <span class="text-yellow-500 font-medium">â˜… ãŠã™ã™ã‚åº¦ 4.8</span>
        </div>
      </div>

      <!-- Recipe 2 -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center gap-2">
            <span class="bg-orange-100 text-orange-700 text-xs font-bold px-2 py-0.5 rounded-md">02</span>
            <h3 class="font-bold text-sm text-gray-800">ã»ã†ã‚Œã‚“è‰ã¨ãƒãƒ¼ã‚ºã®ã‚ªãƒ ãƒ¬ãƒ„</h3>
          </div>
          <span class="text-xs text-gray-400 bg-gray-50 px-2 py-1 rounded-lg font-medium">â± 15åˆ†</span>
        </div>
        <p class="text-xs text-gray-500 mb-3">åµãƒ»ã»ã†ã‚Œã‚“è‰ãƒ»ãƒãƒ¼ã‚ºãƒ»ã—ã‚ã˜ãƒ»ãƒã‚¿ãƒ¼ãƒ»ç‰›ä¹³</p>
        <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-3">
          <p class="text-xs text-gray-600 leading-relaxed"><span class="font-semibold text-gray-700">ä½œã‚Šæ–¹ï¼š</span>ã»ã†ã‚Œã‚“è‰ã‚’èŒ¹ã§ã¦åˆ»ã¿ã€ã—ã‚ã˜ã¯å°æˆ¿ã«åˆ†ã‘ã¦ãƒã‚¿ãƒ¼ã§ç‚’ã‚ã‚‹ã€‚åµ3å€‹ã«ç‰›ä¹³å¤§ã•ã˜2ã‚’æ··ãœã€ç‚’ã‚ãŸå…·æã¨ãƒãƒ¼ã‚ºã‚’åŠ ãˆã¦ãƒ•ãƒ©ã‚¤ãƒ‘ãƒ³ã§ç„¼ãã€‚åŠç†Ÿã«ãªã£ãŸã‚‰åŠåˆ†ã«æŠ˜ã‚Šç•³ã‚“ã§å®Œæˆã€‚</p>
        </div>
        <div class="flex items-center gap-3 mt-2 text-xs text-gray-400">
          <span>ğŸ”¥ ç´„310kcal</span>
          <span>ğŸ‘¤ 1äººå‰</span>
          <span class="text-yellow-500 font-medium">â˜… ãŠã™ã™ã‚åº¦ 4.5</span>
        </div>
      </div>

      <!-- Recipe 3 -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center gap-2">
            <span class="bg-orange-100 text-orange-700 text-xs font-bold px-2 py-0.5 rounded-md">03</span>
            <h3 class="font-bold text-sm text-gray-800">è¦ªå­ä¸¼</h3>
          </div>
          <span class="text-xs text-gray-400 bg-gray-50 px-2 py-1 rounded-lg font-medium">â± 20åˆ†</span>
        </div>
        <p class="text-xs text-gray-500 mb-3">é¶ã‚‚ã‚‚è‚‰ãƒ»ç‰ã­ããƒ»åµãƒ»ã»ã†ã‚Œã‚“è‰</p>
        <div class="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-3">
          <p class="text-xs text-gray-600 leading-relaxed"><span class="font-semibold text-gray-700">ä½œã‚Šæ–¹ï¼š</span>é¶ã‚‚ã‚‚è‚‰ã‚’è–„åˆ‡ã‚Šã€ç‰ã­ãã¯è–„åˆ‡ã‚Šã«ã€‚ã ã—200mlãƒ»é†¤æ²¹å¤§ã•ã˜2ãƒ»ã¿ã‚Šã‚“å¤§ã•ã˜2ã§é¶è‚‰ã¨ç‰ã­ãã‚’ç…®ã‚‹ã€‚ç«ãŒé€šã£ãŸã‚‰æº¶ãåµã‚’å›ã—å…¥ã‚Œã€ã»ã†ã‚Œã‚“è‰ã‚’æ·»ãˆã¦ã”é£¯ã«ã®ã›ã‚‹ã€‚</p>
        </div>
        <div class="flex items-center gap-3 mt-2 text-xs text-gray-400">
          <span>ğŸ”¥ ç´„550kcal</span>
          <span>ğŸ‘¤ 1äººå‰</span>
          <span class="text-yellow-500 font-medium">â˜… ãŠã™ã™ã‚åº¦ 4.6</span>
        </div>
      </div>

      <!-- Nutrition tip -->
      <div class="result-card bg-white rounded-2xl p-4 shadow-sm border border-orange-100">
        <div class="flex items-center gap-2 mb-2">
          <span class="text-lg">ğŸ¥—</span>
          <h3 class="font-bold text-sm text-gray-800">æ „é¤Šã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
        </div>
        <p class="text-sm text-gray-600 leading-relaxed">å†·è”µåº«ã®é£Ÿæã¯ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯å¥½ã§ã™ã€‚ã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼ˆé¶è‚‰ãƒ»åµï¼‰ã€ãƒ“ã‚¿ãƒŸãƒ³ï¼ˆã«ã‚“ã˜ã‚“ãƒ»ã»ã†ã‚Œã‚“è‰ï¼‰ã€ç‚­æ°´åŒ–ç‰©ï¼ˆã˜ã‚ƒãŒã„ã‚‚ï¼‰ãŒæƒã£ã¦ã„ã¾ã™ã€‚ä»Šæ—¥ä¸­ã«ä½¿ã„åˆ‡ã‚ŠãŸã„é£Ÿæã¯<span class="font-semibold text-orange-600">ã»ã†ã‚Œã‚“è‰</span>ã¨<span class="font-semibold text-orange-600">ã—ã‚ã˜</span>ã§ã™ã€‚é®®åº¦ã®é«˜ã„ã†ã¡ã«èª¿ç†ã—ã¾ã—ã‚‡ã†ã€‚</p>
      </div>

      <!-- Action buttons -->
      <div class="flex gap-2 pt-1">
        <button onclick="copyResult('recipe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
          ã‚³ãƒ”ãƒ¼
        </button>
        <button onclick="downloadResult('recipe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
          ä¿å­˜
        </button>
        <button onclick="retryAnalysis('recipe')" class="action-btn flex-1 bg-white border border-orange-200 text-orange-600 font-medium py-2.5 rounded-xl text-xs flex items-center justify-center gap-1.5 shadow-sm">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
          å†åˆ†æ
        </button>
      </div>
    </div>
  </div>

</main>

<!-- Bottom Navigation -->
<nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-lg border-t border-orange-100 z-50 shadow-[0_-4px_20px_rgba(0,0,0,0.05)]">
  <div class="max-w-lg mx-auto flex items-center justify-around py-2 px-2">
    <button onclick="switchTab('wardrobe')" id="nav-wardrobe" class="nav-item active flex flex-col items-center gap-0.5 py-1.5 px-4 rounded-xl">
      <span class="text-xl">ğŸ‘—</span>
      <span class="text-[10px] font-semibold">ã‚³ãƒ¼ãƒ‡ææ¡ˆ</span>
    </button>
    <button onclick="switchTab('calorie')" id="nav-calorie" class="nav-item flex flex-col items-center gap-0.5 py-1.5 px-4 rounded-xl text-gray-400">
      <span class="text-xl">ğŸ±</span>
      <span class="text-[10px] font-semibold">ã‚«ãƒ­ãƒªãƒ¼è§£æ</span>
    </button>
    <button onclick="switchTab('recipe')" id="nav-recipe" class="nav-item flex flex-col items-center gap-0.5 py-1.5 px-4 rounded-xl text-gray-400">
      <span class="text-xl">ğŸ§‘â€ğŸ³</span>
      <span class="text-[10px] font-semibold">ãƒ¬ã‚·ãƒ”ææ¡ˆ</span>
    </button>
  </div>
  <div class="h-[env(safe-area-inset-bottom)]"></div>
</nav>

<script>
// ===== State =====
const state = {
  activeTab: 'wardrobe',
  uploads: { wardrobe: false, calorie: false, recipe: false },
  analyzed: { wardrobe: false, calorie: false, recipe: false }
};

// ===== Header: Date, Time, Greeting =====
function updateHeader() {
  const now = new Date();
  const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
  const dateStr = `${now.getFullYear()}å¹´${now.getMonth() + 1}æœˆ${now.getDate()}æ—¥ï¼ˆ${days[now.getDay()]}ï¼‰`;
  const timeStr = now.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });

  document.getElementById('header-date').textContent = dateStr;
  document.getElementById('header-time').textContent = timeStr;

  const hour = now.getHours();
  let emoji, greeting, sub;

  if (hour >= 5 && hour < 10) {
    emoji = 'ğŸŒ…';
    greeting = 'ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼';
    sub = 'ç´ æ•µãªä¸€æ—¥ã®ã‚¹ã‚¿ãƒ¼ãƒˆã‚’AIãŒã‚µãƒãƒ¼ãƒˆã—ã¾ã™';
  } else if (hour >= 10 && hour < 12) {
    emoji = 'â˜€ï¸';
    greeting = 'è‰¯ã„åˆå‰ã§ã™ã­ï¼';
    sub = 'ä»Šæ—¥ã‚‚å…ƒæ°—ã«ã„ãã¾ã—ã‚‡ã†';
  } else if (hour >= 12 && hour < 14) {
    emoji = 'ğŸ½ï¸';
    greeting = 'ãƒ©ãƒ³ãƒã‚¿ã‚¤ãƒ ã§ã™ï¼';
    sub = 'ã‚«ãƒ­ãƒªãƒ¼è§£æã§è³¢ãé£Ÿäº‹ç®¡ç†ã—ã¾ã›ã‚“ã‹ï¼Ÿ';
  } else if (hour >= 14 && hour < 17) {
    emoji = 'ğŸŒ¤ï¸';
    greeting = 'ã“ã‚“ã«ã¡ã¯ï¼';
    sub = 'åˆå¾Œã‚‚DailyAIã¨ä¸€ç·’ã«éã”ã—ã¾ã—ã‚‡ã†';
  } else if (hour >= 17 && hour < 20) {
    emoji = 'ğŸŒ‡';
    greeting = 'ãŠç–²ã‚Œã•ã¾ã§ã™ï¼';
    sub = 'ä»Šæ—¥ã®å¤•é£Ÿãƒ¬ã‚·ãƒ”ã‚’AIã«èã„ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ';
  } else if (hour >= 20 && hour < 23) {
    emoji = 'ğŸŒ™';
    greeting = 'ã“ã‚“ã°ã‚“ã¯ï¼';
    sub = 'æ˜æ—¥ã®ã‚³ãƒ¼ãƒ‡ã‚’ä»Šã®ã†ã¡ã«æº–å‚™ã—ã¾ã—ã‚‡ã†';
  } else {
    emoji = 'ğŸŒŸ';
    greeting = 'å¤œæ›´ã‹ã—ã§ã™ã‹ï¼Ÿ';
    sub = 'ã—ã£ã‹ã‚Šä¼‘ã‚“ã§æ˜æ—¥ã«å‚™ãˆã¾ã—ã‚‡ã†';
  }

  document.getElementById('greeting-emoji').textContent = emoji;
  document.getElementById('greeting-text').textContent = greeting;
  document.getElementById('greeting-sub').textContent = sub;
}

updateHeader();
setInterval(updateHeader, 30000);

// ===== Tab Switching =====
function switchTab(tab) {
  if (state.activeTab === tab) return;

  const oldPanel = document.getElementById(`panel-${state.activeTab}`);
  const newPanel = document.getElementById(`panel-${tab}`);

  // Remove visibility from old panel
  oldPanel.classList.remove('visible');
  setTimeout(() => {
    oldPanel.classList.remove('active');

    // Activate new panel
    newPanel.classList.add('active');
    requestAnimationFrame(() => {
      requestAnimationFrame(() => {
        newPanel.classList.add('visible');
      });
    });
  }, 200);

  // Update nav items
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
    item.classList.add('text-gray-400');
  });
  const navItem = document.getElementById(`nav-${tab}`);
  navItem.classList.add('active');
  navItem.classList.remove('text-gray-400');

  state.activeTab = tab;

  // Scroll to top
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ===== File Upload Handling =====
function handleDragOver(e, zone) {
  e.preventDefault();
  e.stopPropagation();
  zone.classList.add('dragover');
}

function handleDragLeave(e, zone) {
  e.preventDefault();
  e.stopPropagation();
  zone.classList.remove('dragover');
}

function handleDrop(e, zone, tool) {
  e.preventDefault();
  e.stopPropagation();
  zone.classList.remove('dragover');

  const files = e.dataTransfer.files;
  if (files.length > 0 && files[0].type.startsWith('image/')) {
    processFile(files[0], tool);
  }
}

function handleFileSelect(input, tool) {
  if (input.files.length > 0) {
    processFile(input.files[0], tool);
  }
}

function processFile(file, tool) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const placeholder = document.getElementById(`upload-${tool}-placeholder`);
    const previewContainer = document.getElementById(`upload-${tool}-preview`);
    const previewImg = document.getElementById(`preview-${tool}`);
    const uploadZone = document.getElementById(`upload-${tool}`);

    previewImg.src = e.target.result;
    placeholder.classList.add('hidden');
    previewContainer.classList.remove('hidden');
    uploadZone.classList.add('has-image');

    state.uploads[tool] = true;
    document.getElementById(`btn-${tool}`).disabled = false;

    // Reset results if re-uploading
    if (state.analyzed[tool]) {
      document.getElementById(`result-${tool}`).classList.add('hidden');
      state.analyzed[tool] = false;
    }
  };
  reader.readAsDataURL(file);
}

// ===== Analysis Functions =====
function showLoading(tool) {
  const btn = document.getElementById(`btn-${tool}`);
  const text = document.getElementById(`btn-${tool}-text`);
  const loading = document.getElementById(`btn-${tool}-loading`);

  btn.disabled = true;
  text.classList.add('hidden');
  loading.classList.remove('hidden');
}

function hideLoading(tool) {
  const btn = document.getElementById(`btn-${tool}`);
  const text = document.getElementById(`btn-${tool}-text`);
  const loading = document.getElementById(`btn-${tool}-loading`);

  btn.disabled = false;
  text.classList.remove('hidden');
  loading.classList.add('hidden');
}

function showResults(tool) {
  const container = document.getElementById(`result-${tool}`);
  container.classList.remove('hidden');

  const cards = container.querySelectorAll('.result-card');
  cards.forEach((card, index) => {
    setTimeout(() => {
      card.classList.add('show');
    }, index * 150);
  });

  state.analyzed[tool] = true;
}

function analyzeWardrobe() {
  if (!state.uploads.wardrobe) return;
  showLoading('wardrobe');

  setTimeout(() => {
    hideLoading('wardrobe');
    showResults('wardrobe');
  }, 2000);
}

function analyzeCalorie() {
  if (!state.uploads.calorie) return;
  showLoading('calorie');

  setTimeout(() => {
    hideLoading('calorie');
    showResults('calorie');
  }, 2000);
}

function analyzeRecipe() {
  if (!state.uploads.recipe) return;
  showLoading('recipe');

  setTimeout(() => {
    hideLoading('recipe');
    showResults('recipe');
  }, 2000);
}

// ===== Action Buttons =====
function showToast(message) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.classList.add('show');
  setTimeout(() => {
    toast.classList.remove('show');
  }, 2000);
}

function copyResult(tool) {
  const resultTexts = {
    wardrobe: `ã€DailyAI ã‚³ãƒ¼ãƒ‡ææ¡ˆã€‘
ğŸŒ¤ï¸ å¤©æ°—: 22Â°C æ™´ã‚Œæ™‚ã€…æ›‡ã‚Šï¼ˆæ¹¿åº¦55%ã€é™æ°´ç¢ºç‡10%ï¼‰

âœ¨ ãŠã™ã™ã‚ã‚³ãƒ¼ãƒ‡
ğŸ‘• ãƒˆãƒƒãƒ—ã‚¹: ãƒ™ãƒ¼ã‚¸ãƒ¥ã®ãƒªãƒãƒ³ã‚·ãƒ£ãƒ„ - è»½ã„ç´ æã§å¿«é©ã€‚è¢–ã‚’ãƒ­ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨çˆ½ã‚„ã‹ã«
ğŸ‘– ãƒœãƒˆãƒ ã‚¹: ãƒã‚¤ãƒ“ãƒ¼ã®ãƒ¯ã‚¤ãƒ‰ãƒ‘ãƒ³ãƒ„ - ã‚†ã£ãŸã‚Šã‚·ãƒ«ã‚¨ãƒƒãƒˆã§ãƒªãƒ©ãƒƒã‚¯ã‚¹æ„Ÿã‚’æ¼”å‡º
ğŸ‘Ÿ ã‚·ãƒ¥ãƒ¼ã‚º: ç™½ã®ãƒ¬ã‚¶ãƒ¼ã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼ - æ¸…æ½”æ„Ÿã®ã‚ã‚‹è¶³å…ƒã§å…¨ä½“ã‚’å¼•ãç· ã‚

ğŸ’¡ ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚³ãƒ„
ã‚¢ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼ã§çµ±ä¸€ã™ã‚‹ã¨ã¾ã¨ã¾ã‚Šæ„ŸUPã€‚ã‚´ãƒ¼ãƒ«ãƒ‰ç³»ã®ã‚¢ã‚¯ã‚»ã‚µãƒªãƒ¼ã§ãŠã—ã‚ƒã‚Œæ„Ÿã‚’ã€‚æ—¥å·®ã—ãŒå¼·ã„ã®ã§ã‚µãƒ³ã‚°ãƒ©ã‚¹ã‚‚ãŠã™ã™ã‚ã€‚`,

    calorie: `ã€DailyAI ã‚«ãƒ­ãƒªãƒ¼è§£æã€‘
ğŸ” æ¤œå‡º: é¶ã®ç…§ã‚Šç„¼ãå®šé£Ÿï¼ˆç…§ã‚Šç„¼ããƒã‚­ãƒ³ãƒ»ç™½ç±³ãƒ»å‘³å™Œæ±ãƒ»ã‚µãƒ©ãƒ€ãƒ»æ¼¬ç‰©ï¼‰

ğŸ”¥ ç·ã‚«ãƒ­ãƒªãƒ¼: 687 kcal
â”œ ã‚¿ãƒ³ãƒ‘ã‚¯è³ª: 38.2g
â”œ è„‚è³ª: 18.5g
â”œ ç‚­æ°´åŒ–ç‰©: 82.1g
â”œ é£Ÿç‰©ç¹Šç¶­: 4.8g
â”” ç³–è³ª: 77.3g

âš ï¸ å¡©åˆ†æ³¨æ„: æ¨å®š3.8gï¼ˆ1æ—¥ç›®æ¨™7.5gã®ç´„åŠåˆ†ï¼‰

ğŸ’¡ ã‚¢ãƒ‰ãƒã‚¤ã‚¹
ãƒ»ç™½ç±³ã‚’ç„ç±³ã«å¤‰ãˆã‚‹ã¨é£Ÿç‰©ç¹Šç¶­ãŒç´„3å€ã«
ãƒ»ã‚µãƒ©ãƒ€ã«ã‚¢ãƒãƒ‹æ²¹ã‚’ã‹ã‘ã‚‹ã¨ã‚ªãƒ¡ã‚¬3è£œçµ¦
ãƒ»å…¨ä½“çš„ã«ãƒãƒ©ãƒ³ã‚¹è‰¯å¥½ã§ã™`,

    recipe: `ã€DailyAI ãƒ¬ã‚·ãƒ”ææ¡ˆã€‘
ğŸ¥¬ æ¤œå‡ºé£Ÿæ: é¶ã‚‚ã‚‚è‚‰ãƒ»ã«ã‚“ã˜ã‚“ãƒ»ç‰ã­ããƒ»ã˜ã‚ƒãŒã„ã‚‚ãƒ»åµãƒ»ç‰›ä¹³ãƒ»ã—ã‚ã˜ãƒ»ã»ã†ã‚Œã‚“è‰ãƒ»ãƒã‚¿ãƒ¼ãƒ»ãƒãƒ¼ã‚º

01. ãƒã‚­ãƒ³ã‚¯ãƒªãƒ¼ãƒ ã‚·ãƒãƒ¥ãƒ¼ï¼ˆ35åˆ†ãƒ»ç´„420kcalãƒ»2äººå‰ï¼‰
é¶ã‚‚ã‚‚è‚‰ã‚’ä¸€å£å¤§ã«åˆ‡ã‚Šã€ãƒã‚¿ãƒ¼ã§ç‚’ã‚ã€é‡èœã¨ã—ã‚ã˜ã‚’åŠ ãˆã¦æ°´400mlã§15åˆ†ç…®è¾¼ã‚€ã€‚ç‰›ä¹³200mlã¨å°éº¦ç²‰å¤§ã•ã˜2ã‚’åŠ ãˆã¦ã¨ã‚ã¿ãŒã¤ãã¾ã§ç…®ã‚‹ã€‚

02. ã»ã†ã‚Œã‚“è‰ã¨ãƒãƒ¼ã‚ºã®ã‚ªãƒ ãƒ¬ãƒ„ï¼ˆ15åˆ†ãƒ»ç´„310kcalãƒ»1äººå‰ï¼‰
ã»ã†ã‚Œã‚“è‰ã¨ã—ã‚ã˜ã‚’ãƒã‚¿ãƒ¼ã§ç‚’ã‚ã€åµ3å€‹ã«ç‰›ä¹³å¤§ã•ã˜2ã‚’æ··ãœã¦ç„¼ãã€‚ãƒãƒ¼ã‚ºã‚’åŠ ãˆã¦åŠåˆ†ã«æŠ˜ã‚Šç•³ã‚€ã€‚

03. è¦ªå­ä¸¼ï¼ˆ20åˆ†ãƒ»ç´„550kcalãƒ»1äººå‰ï¼‰
ã ã—200mlãƒ»é†¤æ²¹å¤§ã•ã˜2ãƒ»ã¿ã‚Šã‚“å¤§ã•ã˜2ã§é¶è‚‰ã¨ç‰ã­ãã‚’ç…®ã¦ã€æº¶ãåµã‚’å›ã—å…¥ã‚Œã‚‹ã€‚

ğŸ¥— æ „é¤Šã‚¢ãƒ‰ãƒã‚¤ã‚¹: ã»ã†ã‚Œã‚“è‰ã¨ã—ã‚ã˜ã¯æ—©ã‚ã«ä½¿ã„åˆ‡ã‚Šã¾ã—ã‚‡ã†ã€‚`
  };

  navigator.clipboard.writeText(resultTexts[tool]).then(() => {
    showToast('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
  }).catch(() => {
    // Fallback for older browsers
    const textArea = document.createElement('textarea');
    textArea.value = resultTexts[tool];
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
    showToast('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
  });
}

function downloadResult(tool) {
  const titles = {
    wardrobe: 'ã‚³ãƒ¼ãƒ‡ææ¡ˆ',
    calorie: 'ã‚«ãƒ­ãƒªãƒ¼è§£æ',
    recipe: 'ãƒ¬ã‚·ãƒ”ææ¡ˆ'
  };

  const resultContainer = document.getElementById(`result-${tool}`);
  const textContent = resultContainer.innerText;

  const now = new Date();
  const dateStr = `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}`;

  const blob = new Blob([`DailyAI ${titles[tool]} - ${dateStr}\n${'='.repeat(40)}\n\n${textContent}`], { type: 'text/plain;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `dailyai_${tool}_${dateStr}.txt`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);

  showToast('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ');
}

function retryAnalysis(tool) {
  // Hide current results with animation
  const container = document.getElementById(`result-${tool}`);
  const cards = container.querySelectorAll('.result-card');
  cards.forEach(card => card.classList.remove('show'));

  setTimeout(() => {
    container.classList.add('hidden');
    state.analyzed[tool] = false;

    // Run analysis again
    if (tool === 'wardrobe') analyzeWardrobe();
    else if (tool === 'calorie') analyzeCalorie();
    else if (tool === 'recipe') analyzeRecipe();
  }, 300);
}

// ===== Initialize =====
document.addEventListener('DOMContentLoaded', () => {
  // Set initial panel state
  const firstPanel = document.getElementById('panel-wardrobe');
  firstPanel.classList.add('active', 'visible');
});
</script>
</body>
</html>
